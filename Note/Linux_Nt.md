Linux Note

**类Unix系统目录结构**

​	一切皆文件

​		

![类Unix系统目录结构](D:\work\Myhub\Note\Picture\类Unix系统目录结构.png)

文件信息：

```
-/xxx/xxx/xxx 1 用户组 时间
首位表示文件类型：
	-：普通文件
	d目录
	l：符号连接文件（软连接）
	b：块文件
	c：为字符设备（键盘、鼠标）
	p：管道设备
	s：本地套接字
后面三个为一组，依次为归属用户的权限，归属组的权限，归属其他用户的权限，r表示可读，w表示可写,x表示可执行，-为无权限，权限位可以写成一个八进制数，四位八进制数0XXX可以表示文件权限，称为权限位数字表示法
数字为硬连接计数
硬连接：使用同一块磁盘区域
软连接：类似于快捷方式
用户家目录下的.bashrc文件加载用户选项
```

**指令意义**

```
用户名@机器名:~/当前目录$
~表示用户家目录，例如：/home/leonardo
$表示当前权限为一般用户，若为管理员，显示#
```



**常用指令**

```
sudo su		//切换到管理员
alias		//自定义指令别名

查看：
    history		//查看历史指令
    ls <目录>	   //查看文件信息， -R 显示文件具体结构
    pwd			//显示当前工作目录
    tree <目录>  //显示文件树
    cat	<文件>	//直接显示文件信息
    more/less 	//查看文件（和cat相似）
    head/tail	//显示头/尾文件内容，默认显示10行， -n参数指定行数。tail的-f参数能实时显示文件尾的变动
	man		//帮助手册
	echo	//显示变量或字符串
	date 	//查看日期 date +"%Y%m%d"
	umask	//查看补码， -s文字显示文件权限

操作：
    mkdir		//创建目录，支持同时创建多个目录，用空格分隔。-p 递归的创建多个目录
    rmdir <目录>	//删除目录，只能删除空目录，支持同时删除多个目录，用空格分隔。 -p从子目录递归删除空目录
    rm <文件>		//删除文件， -r 删除目录
    which <指令>	//显示对应指令所在位置
    touch <文件名>	//创建文件
    cp <文件> <目录> //拷贝文件到目标目录， -r 递归拷贝<目录1>到<目录2>下。若目录2最小子目录不存在则将	目录1拷贝到该位置并改名为该子目录
    cp <文件1> <文件2>	//拷贝文件1到文件2，若文件2不存在则创建
    mv	//和cp命令基本相同，但mv不保留原文件
    
    ln <文件1> <文件2>	//创建文件2连接到文件1， -s参数创建软连接
    unlink	//删除软硬连接，当硬连接计数为0时删除文件
    
    chmod	//改变文件权限， u/g/o/a +/- rwx 参数表示用户/组/其他用户/所有 增加/减少 各种权限
	chown 用户:组 <文件>	//改变文件归属（需要管理员权限）

统计：
    wc	//文件统计， 显示文件的行数，单词数，字节数， 可用-l、-w、-c分别显示
    du	//查看目录占用空间，-h参数显示适合人类观看格式， --max-depth=x 参数设置显示目录深度
    df	//查看当前文件系统使用情况
```

**高级指令**

```
查找：

	命令后接 -exec + 指令 {} \;	//将查找到的内容传给后方指令
	接|xargs + 指令 	//将查找到的内容分段传给后方指令，防止溢出
	
	find dir [option] target	//在指定目录下查找目标， 
		-name “XXX(正则)”	按名字查找相应目录下的文件
		-type <类型字母>   按类型查找文件，普通文件特别用f查找
		-size 			 按大小查找
		-maxdepth X		 指定查找

	grep [option] dir/file_name		//过滤内容
		-r	递归子目录

压缩：
	
	zip	XX.zip file_name	//压缩文件，-r参数递归子目录压缩整个目录
	unzip XX.zip	//解压缩
	
	gzip/gunzip		//打包单个文件生成.gz文件
	
	gz文件习惯用tar打包， tar -zcvf xx.gz <原料>
		-zxvf参数解压缩
		其中c表示压缩，x表示解压，z表示压缩方式，v表示显示信息(可省略)
		还有j的压缩方式，生成.bzip2文件
	
	rar a -r newdir dir		//.rar格式压缩， a代表压缩，-r递归子目录，压缩包名（不用加后缀） 原材料
	rar x 	//解压
	
安装软件：

	sudo apt-get update		//	更新/etc/apt/sources.list
	sudo apt-get install tree	//	安装tree命令
	sudo apt-get remove tree	//	卸载tree命令
	sudo apt-get clean		//清理包
	
	
	dpkg根据deb安装包安装软件
	sudo dpkg -i XXX.deb	//安装
	sudo dpkg -r XXX.deb	//移除软件包
	
	
	源码安装
	解压压缩包 -> 进入对应目录执行configure文件 ->	make -> sudo make install安装到系统目录下

	
		
```



**Vim的使用**

```
命令模式：
	ctrl s:暂停
	ctrl q:退出暂停
	ZZ:	保存退出
	ctrl c:强制停止
	ctrl w/ww:切换到上分屏/下分屏
	光标移动：	

        除了方向键外还能使用hjkl，分别是左下上右。
        0移动到行首，$移动到行尾，gg到文件头，G到文件尾
        移动到指定行 <行数>+G		

    删除：
        u撤销操作
        x删除光标处字符，X删除光标前字符
        dw从光标位置删除单词
        d$从光标位置后删除行，等效于D
        d0从光标位置前删除行
        dgg从光标所在行前删除所有字符(包含本行)
        dG从光标所在行后删除所有字符(包含本行)
        dj删除本行和下一行所有字符
        dk删除本行和上一行所有字符
        dh、dl等效于X、x
        ndd删除n行字符

    复制粘贴：
        nyy	复制n行
        p/P	粘贴，p粘贴到下一行，P粘贴到本行
        ndd 剪切n行 
        r替换字符
        v进入可视化模式（选中文本），y复制
	
进入编辑模式：

	aios大小写均可进入编辑模式，8种情况光标位置不同
	
	a:光标后移一位
	A:移动到行末
	i:光标位置不变
	I:移动到行首
	o:下方新建空白行
	O:上方新建空白行
	s:删除当前字符
	S:删除当前行
	esc:退出编辑模式

进入末行模式：
	
	: 进入该模式
	!+ shell指令 可以执行对应指令
	s/xxx/xx/ 将当前行第一个匹配的xxx替换为xx， +g替换整行
	%s/xxx/xx/ 将每一行第一个匹配的xxx替换为xx， +g替换整行
	w	写入(保存)
	q	退出，会询问是否保存
	q!	退出不询问
	x	写入并退出
	sp file_name	上下分屏打开文件/	vsp file_name 左右分屏打开文件
	qall:退出全部文件
```



**GCC编译流程**



```
gcc xx.c 	编译.c文件生成可执行文件a.out，实际上这个指令经过了几步操作，也可以分别实现
	gcc -E		预处理——头文件展开、宏替换，可使用 重定向 >(清空目标文件再写入)/>>(追加写入) 将生						成代码写入文件，通常为.i文件
	
	gcc -S 		生成汇编指令xx.s文件
	
	gcc -c		生成二进制目标文件xx.o
	
	链接生成可执行文件a.out
	
gcc xx.c -I dir 包含目录	
	调用另一个源文件的函数:
		1.在a.c 里引用"b.c"并声明b.c里的函数
		2.创建b.h，b.h引用"b.c"并声明b.c里的函数，a.c引用"b.h"
		
-o filename 指定生成的文件 
-lstdc++ 编译cpp文件
-g 使用gba调试模式
-Wall 显示所有警告

静态库

    ar rcs libxxx.a xx.o xx.o ...	打包生成静态库文件
    -L包含库目录， -l指定库名

动态库
	
	1.编译与位置无关的代码。生成.o文件，关键参数 -fPIC
	2.将.o文件打包，关键参数 -shared，例： gcc -shared -o libxx.so xx.o
	3.将库文件与头文件一起发布
	
	使用:
	1.与静态库相同的指令编译出可执行文件
	2.正确配置程序依赖的共享库，可以使用 ldd xxx 查看文件所依赖的共享库列表，配置方法有多种
	
		方法一：将共享库.so文件直接移动到/lib目录下或/usr/lib目录下或在上述目录下建立共享库的连接
		
		方法二：将动态库文件路径配置到$LD_LIBRARY_PATH环境变量下，export(生效一次) LD_LIBRARY_PATH 				=dir:$LD_LIBRARY_PATH
		
		(推荐)方法三：将动态库所在目录添加到/etc/ld.so.conf尾行，运行ldconfig指令
```

